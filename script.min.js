let skills=[{name:"figma",weight:.1,has:!1},{name:"wireframing",weight:.06,has:!1},{name:"prototyping",weight:.08,has:!1},{name:"usability_testing",weight:.08,has:!1},{name:"heuristic_evaluation",weight:.05,has:!1},{name:"user_interviews",weight:.07,has:!1},{name:"accessibility",weight:.06,has:!1},{name:"html_css",weight:.05,has:!1},{name:"javascript",weight:.04,has:!1},{name:"python",weight:.04,has:!1},{name:"sql",weight:.03,has:!1},{name:"ab_testing",weight:.04,has:!1},{name:"data_visualization",weight:.03,has:!1}],totalWeight=skills.reduce(((e,t)=>e+t.weight),0),totalSkills=skills.length,skillsContainer=document.getElementById("skills"),computeButton=document.getElementById("compute"),rawPctEl=document.getElementById("rawPct"),weightedPctEl=document.getElementById("wPct"),missingListEl=document.getElementById("missingList"),explainEl=document.getElementById("explain"),chartCanvas=document.getElementById("chart"),swatches=document.querySelectorAll('.swatch'),downloadBtn=document.getElementById("downloadPdf"),chart=new Chart(chartCanvas,{type:"doughnut",data:{labels:["Covered","Uncovered"],datasets:[{data:[0,totalWeight],backgroundColor:["#22c55e","#334155"],borderColor:["#16a34a","#1f2937"],borderWidth:1}]},options:{cutout:"60%",animation:!1,plugins:{legend:{labels:{color:"#e5e7eb"}}}}});function setAccent(e){document.documentElement.style.setProperty("--accent",e),chart&&(chart.data.datasets[0].backgroundColor=[e,"#334155"],chart.data.datasets[0].borderColor=[shadeColor(e,-12),"#1f2937"],chart.update("none")),localStorage.setItem("accentColor",e),swatches.forEach((t=>t.classList.toggle("active",t.dataset.color===e)))}function shadeColor(e,t){const a=parseInt(e.replace("#",""),16);let i=a>>16&255,o=a>>8&255,l=255&a;return i=Math.max(0,Math.min(255,Math.floor(i*(100+t)/100))),o=Math.max(0,Math.min(255,Math.floor(o*(100+t)/100))),l=Math.max(0,Math.min(255,Math.floor(l*(100+t)/100))),"#"+(1<<24|i<<16|o<<8|l).toString(16).slice(1)}function renderSkills(){let e="";skills.forEach(((t,a)=>{const i=`skill_${a}`;e+=`<label for="${i}" class="${t.has?"selected":""}"><input id="${i}" name="skills" type="checkbox" data-idx="${a}" ${t.has?"checked":""}/> ${t.name.replaceAll("_"," ")}</label>`})),skillsContainer.innerHTML=e}skillsContainer.addEventListener("change",(e=>{const t=e.target;if(t&&t.matches('input[type="checkbox"]')){const e=Number(t.dataset.idx);if(!Number.isNaN(e)){skills[e].has=t.checked;const a=t.closest("label");a&&(t.checked?a.classList.add("selected"):a.classList.remove("selected"))}}}));skillsContainer.addEventListener("click",(e=>{const t=e.target.closest("label");if(!t)return;const a=t.querySelector('input[type="checkbox"]');if(!a)return;a.checked=!a.checked;const i=Number(a.dataset.idx);Number.isNaN(i)||(skills[i].has=a.checked,t.classList.toggle("selected",a.checked))}));function compute(){let e=0,t=0;for(const a of skills)a.has&&(e++,t+=a.weight);const a=e/totalSkills,i=t/totalWeight;rawPctEl.innerText=(100*a).toFixed(1)+"%",weightedPctEl.innerText=(100*i).toFixed(1)+"%";const o=totalWeight-t;chart.data.datasets[0].data=[t,o],chart.update("none");const l=skills.filter((e=>!e.has)).sort(((e,t)=>t.weight-e.weight))[0];missingListEl.innerText=l?"Top missing skill: "+l.name.replaceAll("_"," "):"All skills covered",explainEl.innerText=`Raw coverage counts how many skills are selected (${e} of ${totalSkills}). Weighted coverage sums the importance of selected skills (${t.toFixed(2)} of ${totalWeight.toFixed(2)} total weight).`}computeButton.onclick=compute,renderSkills();const savedAccent=localStorage.getItem("accentColor");savedAccent&&setAccent(savedAccent),swatches.forEach((e=>e.addEventListener("click",(()=>setAccent(e.dataset.color))))),null==downloadBtn||downloadBtn.addEventListener("click",(async()=>{const{jsPDF:e}=(window.jspdf||{}),t=document.getElementById("main");if(!t||!window.html2canvas||!e)return;const a=await window.html2canvas(t,{backgroundColor:"#0f172a",scale:1});const i=1600;let o=a;if(Math.max(a.width,a.height)>i){const e=i/Math.max(a.width,a.height),t=document.createElement("canvas");t.width=Math.floor(a.width*e),t.height=Math.floor(a.height*e);const n=t.getContext("2d");n.imageSmoothingQuality="high",n.drawImage(a,0,0,t.width,t.height),o=t}const l=972800,c=e=>{const t=e.split(",")[1]||"";return atob(t).length};let d=.75,r=o.toDataURL("image/jpeg",d),s=0;for(;c(r)>l&&d>.2&&s<10;)d-=.1,r=o.toDataURL("image/jpeg",d),s++;for(s=0;c(r)>l&&s<3;){const e=document.createElement("canvas");e.width=Math.floor(o.width*.9),e.height=Math.floor(o.height*.9);const t=e.getContext("2d");t.imageSmoothingQuality="high",t.drawImage(o,0,0,e.width,e.height),o=e,r=o.toDataURL("image/jpeg",d),s++}const h=new e({orientation:"landscape",unit:"pt",format:"a4",compress:!0}),g=h.internal.pageSize.getWidth(),m=h.internal.pageSize.getHeight(),u=Math.min(g/o.width,m/o.height),f=o.width*u,p=o.height*u,_=(g-f)/2;h.addImage(r,"JPEG",_,36,f,p);const b=(new Date).toLocaleString();h.setFontSize(10),h.setTextColor("#6b7280"),h.text(`Generated: ${b}`,g-24,m-16,{align:"right"}),h.save("skill_coverage_report.pdf")}));
